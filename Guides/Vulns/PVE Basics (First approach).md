https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/

**Look for Interesting files:**
-  `ls -la` at: ^7e66d9
	- /home
	- /home/`<user>`
	- /etc/nginx/sites-enabled
	- /etc/apache2/sites-enabled
	- /var/www/
	- /opt
	- /var/opt
	- /

**Running Processes**
- let `pspy` run for 5' and check if there is some cron task ^8ee551

**Writable path in PATH env-variable?** ^adfc43
- If some part of the `PATH` variable is writable, it can lead to poison some script with a custom one
	- In combination with a root SUID or SUDO allowed script, might mean root access

**Running services** `systemctl`

**Locally exposed ports**
- `ss`
- `netstat -tulpn` | `netstat -punta` | `netstat -nat` ^1fbded
	- also can add `| grep LISTEN`

**Globally grep for the desired user** ^c1241b
- In some cases must be useful just grep for an username in order to found some leaks:
	- `grep -r '<username>' / 2>/dev/null`

**Available capabilities** (maybe there is some [[Useful Capabilities Vulnerabilities]])
-  `getcap -r / 2>/dev/null`	 ^0b14bc

**Some strange groups?**
- run `id` command ^a82e53
	- The expected output would be: `uid=1001(<user>) gid=1001(<user>) groups=1001(<user>)`

**Look for privileged scripts/commands**
- run `sudo -l` command ^053b9d
	- expected output would be: `<user> must not run sudo on <hostname>`
- run `find / -perm -4000 2>/dev/null` ^45633c
	-  expected output would be (something like this): 
```
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/gpasswd
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/at
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/su
/usr/bin/fusermount
/usr/bin/passwd
/usr/bin/mount
/usr/bin/umount	
```

**Found privileged scripts?** ^d51a69
- Look for credentials leakage at src code ^4889d1
- Look EVERY binary that's being used inside the script for vulnerabilities
	- http://www.exploit-db.com and search by name
	- Google search and look for CVE's PoC
		- `<name> vulnerabilities CVE` 
		- `<name> exploits pve` 
- Check if some script is being used with a relative path
	- Maybe running the script from another dir and overwritting the binary works

**gtfobins**
- If i found some custom binaries, search them in `gtfobins.github.io`

**linepas.sh**
- Run `LinPeas.sh` to look for vulnerabilities in the system

**chmod u+s**
- If i want to become another user i can copy the `/bin/bash` to another file and give it `SUID` permissions. 
	- `cp /bin/bash /tmp/bash; chmod u+s /tmp/bash` ^89d4f7
	- Also, if the user is root i can directly set the `/bin/bash` witth SUID permissions


**Ways to become root with a privileged oneliner**
- `chmod u+s /bin/bash`
- `echo '<user> ALL=(ALL:ALL) ALL' >> /etc/sudoers`